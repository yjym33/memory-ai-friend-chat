# Anthropic API ν‚¤ μ €μ¥ λ° μ‚¬μ© λ¬Έμ  ν•΄κ²° κ°€μ΄λ“

## λ¬Έμ  μƒν™©

ν”„λ΅ νΈμ—”λ“μ—μ„ `ANTHROPIC_API_KEY`λ¥Ό μ…λ ¥ν•κ³  μ €μ¥ν–λ”λ° LLM νΈμ¶μ΄ μ• λλ” κ²½μ°μ μ›μΈ λ¶„μ„ λ° ν•΄κ²° λ°©λ²•μ…λ‹λ‹¤.

## κ°€λ¥ν• μ›μΈ

### 1. API ν‚¤κ°€ μ‹¤μ λ΅ μ €μ¥λμ§€ μ•μ•μ„ μ μμ β οΈ (κ°€μ¥ κ°€λ¥μ„± λ†’μ)

**μ¦μƒ:**
- ν”„λ΅ νΈμ—”λ“μ—μ„ "API ν‚¤κ°€ μ €μ¥λμ—μµλ‹λ‹¤!" λ©”μ‹μ§€κ°€ λ‚μ™”μ§€λ§
- μ‹¤μ λ΅ λ°μ΄ν„°λ² μ΄μ¤μ— μ €μ¥λμ§€ μ•μ•μ„ μ μμ

**ν™•μΈ λ°©λ²•:**
- λΈλΌμ°μ € κ°λ°μ λ„κµ¬μ Network νƒ­μ—μ„ `/auth/api-keys/all` μ”μ²­ ν™•μΈ
- μ”μ²­μ΄ μ„±κ³µν–λ”μ§€ (200 OK) ν™•μΈ
- λ°±μ—”λ“ λ΅κ·Έμ—μ„ λ‹¤μ λ©”μ‹μ§€ ν™•μΈ:
  ```
  π“¥ API ν‚¤ μ €μ¥ μ”μ²­: { userId: '...', providers: ['anthropic'], hasAnthropic: true }
  β… anthropic API ν‚¤ μ €μ¥ μ™„λ£ - μ•”νΈν™”λ ν‚¤ κΈΈμ΄: ...
  β… λ³µνΈν™” ν…μ¤νΈ μ„±κ³µ - ν‚¤ μ‹μ‘: sk-ant-...
  π’Ύ λ¨λ“  API ν‚¤ μ €μ¥ μ™„λ£ - μ €μ¥λ Provider: ["anthropic"]
  ```

**ν•΄κ²° λ°©λ²•:**
- Network νƒ­μ—μ„ μ”μ²­ μ‹¤ν¨ μ‹ μ—λ¬ λ©”μ‹μ§€ ν™•μΈ
- λ°±μ—”λ“ λ΅κ·Έ ν™•μΈν•μ—¬ μ €μ¥ κ³Όμ •μ λ¬Έμ  νμ•…

### 2. AI μ„¤μ •μ—μ„ Providerκ°€ AnthropicμΌλ΅ λ³€κ²½λμ§€ μ•μ

**μ¦μƒ:**
- API ν‚¤λ” μ €μ¥λμ—μ§€λ§
- AI μ„¤μ •μ `llmProvider`κ°€ μ—¬μ „ν `openai`μΌ μ μμ

**ν™•μΈ λ°©λ²•:**
- AI μ„¤μ • λ¨λ‹¬μ—μ„ Provider ν™•μΈ
- λ°±μ—”λ“ λ΅κ·Έμ—μ„ `llmProvider` κ°’ ν™•μΈ:
  ```
  π”‘ [μ¤νΈλ¦¬λ°] anthropic API ν‚¤ μƒνƒ: ...
  ```

**ν•΄κ²° λ°©λ²•:**
1. AI μ„¤μ • λ¨λ‹¬ μ—΄κΈ°
2. "π¤– AI λ¨λΈ" νƒ­ μ„ νƒ
3. **Providerλ¥Ό "Anthropic (Claude)"λ΅ λ³€κ²½**
4. **λ¨λΈμ„ Anthropic λ¨λΈλ΅ μ„ νƒ** (μ: "Claude 3.5 Sonnet")
5. μ €μ¥

### 3. λ¨λΈμ΄ Anthropic λ¨λΈμ΄ μ•„λ‹ μ μμ

**μ¦μƒ:**
- Providerλ” `anthropic`μ΄μ§€λ§
- λ¨λΈμ΄ `gpt-5.1` λ“± λ‹¤λ¥Έ Providerμ λ¨λΈμΌ μ μμ

**ν™•μΈ λ°©λ²•:**
- AI μ„¤μ •μ—μ„ λ¨λΈ ν™•μΈ
- λ°±μ—”λ“ λ΅κ·Έ ν™•μΈ:
  ```
  β λ¨λΈ 'gpt-5.1'μ€ Provider 'anthropic'μ—μ„ μ§€μ›ν•μ§€ μ•μµλ‹λ‹¤.
  ```

**ν•΄κ²° λ°©λ²•:**
- Anthropic λ¨λΈ λ©λ΅μ—μ„ μ„ νƒ:
  - `claude-3-5-sonnet-20241022` (κ¶μ¥)
  - `claude-3-opus-20240229`
  - `claude-3-sonnet-20240229`
  - `claude-3-haiku-20240307`

### 4. API ν‚¤ λ³µνΈν™” μ‹¤ν¨

**μ¦μƒ:**
- API ν‚¤λ” μ €μ¥λμ—μ§€λ§
- λ³µνΈν™” κ³Όμ •μ—μ„ μ¤λ¥ λ°μƒ

**ν™•μΈ λ°©λ²•:**
- λ°±μ—”λ“ λ΅κ·Έμ—μ„ λ‹¤μ λ©”μ‹μ§€ ν™•μΈ:
  ```
  β μ‚¬μ©μ ...μ anthropic API ν‚¤ λ³µνΈν™” μ‹¤ν¨: ...
  ```

**μ›μΈ:**
- `ENCRYPTION_KEY` ν™κ²½ λ³€μκ°€ λ³€κ²½λμ—μ„ μ μμ
- μ•”νΈν™” ν‚¤κ°€ λ³€κ²½λλ©΄ κΈ°μ΅΄μ— μ•”νΈν™”λ ν‚¤λ” λ³µνΈν™”ν•  μ μ—†μ

**ν•΄κ²° λ°©λ²•:**
- `ENCRYPTION_KEY` ν™κ²½ λ³€μκ°€ λ³€κ²½λμ§€ μ•μ•λ”μ§€ ν™•μΈ
- ν•„μ”μ‹ API ν‚¤λ¥Ό λ‹¤μ‹ μ…λ ¥ν•μ—¬ μ €μ¥

### 5. μ‚¬μ©μ API ν‚¤λ¥Ό μ°Ύμ§€ λ»ν•λ” κ²½μ°

**ν™•μΈ λ°©λ²•:**
- λ°±μ—”λ“ λ΅κ·Έμ—μ„ λ‹¤μ λ©”μ‹μ§€ ν™•μΈ:
  ```
  π” μ‚¬μ©μ ...μ API ν‚¤ μ΅°ν μ¤‘... Provider: anthropic
  π“¦ μ‚¬μ©μ API ν‚¤ κ°μ²΄ μ΅΄μ¬: ["openai"]  // anthropicμ΄ μ—†μ!
  β οΈ μ‚¬μ©μ ...μ anthropic API ν‚¤κ°€ μ €μ¥λμ–΄ μμ§€ μ•μµλ‹λ‹¤.
  ```

**μ›μΈ:**
- API ν‚¤ μ €μ¥ μ‹ Provider μ΄λ¦„μ΄ μλ»λμ—μ„ μ μμ
- λ°μ΄ν„°λ² μ΄μ¤μ— μ €μ¥λμ§€ μ•μ•μ„ μ μμ

**ν•΄κ²° λ°©λ²•:**
- API ν‚¤λ¥Ό λ‹¤μ‹ μ €μ¥
- λ°μ΄ν„°λ² μ΄μ¤ μ§μ ‘ ν™•μΈ:
  ```sql
  SELECT id, email, llmApiKeys FROM "user" WHERE id = 'μ‚¬μ©μID';
  ```

### 6. μ‹μ¤ν… κΈ°λ³Έ ν‚¤λ„ μ—†λ” κ²½μ°

**ν™•μΈ λ°©λ²•:**
- λ°±μ—”λ“ λ΅κ·Έμ—μ„ λ‹¤μ λ©”μ‹μ§€ ν™•μΈ:
  ```
  β Anthropic API ν‚¤λ¥Ό μ°Ύμ„ μ μ—†μµλ‹λ‹¤.
   - μ‚¬μ©μ API ν‚¤: λ―Έμ „λ‹¬
   - ν™κ²½ λ³€μ ANTHROPIC_API_KEY: λ―Έμ„¤μ •
  ```

**ν•΄κ²° λ°©λ²•:**
- `.env` νμΌμ— `ANTHROPIC_API_KEY` μ¶”κ°€
- λλ” ν”„λ΅ νΈμ—”λ“μ—μ„ API ν‚¤ μ…λ ¥ ν›„ μ €μ¥

## λ””λ²„κΉ… μ²΄ν¬λ¦¬μ¤νΈ

### ν”„λ΅ νΈμ—”λ“ ν™•μΈ

- [ ] AI μ„¤μ • λ¨λ‹¬μ—μ„ Providerκ°€ "Anthropic (Claude)"λ΅ μ„ νƒλμ–΄ μλ”κ°€?
- [ ] λ¨λΈμ΄ Anthropic λ¨λΈλ΅ μ„ νƒλμ–΄ μλ”κ°€? (μ: `claude-3-5-sonnet-20241022`)
- [ ] API ν‚¤ μ…λ ¥ ν•„λ“μ— κ°’μ΄ μ…λ ¥λμ–΄ μλ”κ°€?
- [ ] "μ €μ¥" λ²„νΌ ν΄λ¦­ μ‹ Network νƒ­μ—μ„ `/auth/api-keys/all` μ”μ²­μ΄ μ„±κ³µν–λ”κ°€?
- [ ] λΈλΌμ°μ € μ½μ†”μ— μ—λ¬κ°€ μ—†λ”κ°€?

### λ°±μ—”λ“ ν™•μΈ

- [ ] API ν‚¤ μ €μ¥ μ‹ λ΅κ·Έμ— "β… API ν‚¤ μ €μ¥ μ™„λ£" λ©”μ‹μ§€κ°€ μλ”κ°€?
- [ ] λ³µνΈν™” ν…μ¤νΈ λ΅κ·Έμ— "β… λ³µνΈν™” ν…μ¤νΈ μ„±κ³µ" λ©”μ‹μ§€κ°€ μλ”κ°€?
- [ ] LLM νΈμ¶ μ‹ "β… μ‚¬μ©μ ...μ anthropic API ν‚¤ λ³µνΈν™” μ„±κ³µ" λ©”μ‹μ§€κ°€ μλ”κ°€?
- [ ] Anthropic Providerμ—μ„ "π”‘ Anthropic API ν‚¤ ν™•μΈ - μ‚¬μ©μ ν‚¤: μμ" λ©”μ‹μ§€κ°€ μλ”κ°€?

### λ°μ΄ν„°λ² μ΄μ¤ ν™•μΈ

```sql
-- μ‚¬μ©μ API ν‚¤ ν™•μΈ
SELECT 
  id, 
  email, 
  llmApiKeys->>'anthropic' as anthropic_key 
FROM "user" 
WHERE id = 'μ‚¬μ©μID';

-- API ν‚¤κ°€ μμΌλ©΄ μ•”νΈν™”λ λ¬Έμμ—΄μ΄ λ‚μ™€μ•Ό ν•¨
```

## λΉ λ¥Έ ν•΄κ²° λ°©λ²• (μμ„λ€λ΅ μ‹λ„)

### 1λ‹¨κ³„: AI μ„¤μ • ν™•μΈ λ° λ³€κ²½

1. AI μ„¤μ • λ¨λ‹¬ μ—΄κΈ°
2. "π¤– AI λ¨λΈ" νƒ­ μ„ νƒ
3. **Provider**: "Anthropic (Claude)" μ„ νƒ
4. **λ¨λΈ**: "Claude 3.5 Sonnet" μ„ νƒ
5. μ €μ¥

### 2λ‹¨κ³„: API ν‚¤ μ…λ ¥ λ° μ €μ¥

1. "API ν‚¤ μ„¤μ •" β†’ "μ„¤μ •ν•κΈ°" ν΄λ¦­
2. "Anthropic API Key" μ…λ ¥ ν•„λ“μ— `sk-ant-api03-...` μ…λ ¥
3. **λ‹¤μ‹ μ €μ¥** (AI μ„¤μ • μ €μ¥ μ‹ ν•¨κ» μ €μ¥λ¨)
4. λ°±μ—”λ“ λ΅κ·Έμ—μ„ μ €μ¥ μ„±κ³µ λ©”μ‹μ§€ ν™•μΈ

### 3λ‹¨κ³„: LLM νΈμ¶ ν…μ¤νΈ

1. μ±„ν…μ—μ„ λ©”μ‹μ§€ μ „μ†΅
2. λ°±μ—”λ“ λ΅κ·Έμ—μ„ λ‹¤μ ν™•μΈ:
   - API ν‚¤ μ΅°ν λ΅κ·Έ
   - API ν‚¤ λ³µνΈν™” μ„±κ³µ λ΅κ·Έ
   - Anthropic API νΈμ¶ λ΅κ·Έ

### 4λ‹¨κ³„: λ¬Έμ  μ§€μ† μ‹

λ°±μ—”λ“ λ΅κ·Έμ μ—λ¬ λ©”μ‹μ§€λ¥Ό ν™•μΈν•μ—¬ κµ¬μ²΄μ μΈ μ›μΈ νμ•…:

```
β μ‚¬μ©μ ...μ anthropic API ν‚¤ λ³µνΈν™” μ‹¤ν¨: ...
```

λλ”

```
β Anthropic API ν‚¤λ¥Ό μ°Ύμ„ μ μ—†μµλ‹λ‹¤.
```

## μμƒ μ›μΈ μ°μ„ μμ„

1. **Provider/Model μ„¤μ • μ¤λ¥** (70% κ°€λ¥μ„±)
   - Providerκ°€ `anthropic`μ΄ μ•„λ‹
   - λ¨λΈμ΄ Anthropic λ¨λΈμ΄ μ•„λ‹

2. **API ν‚¤ μ €μ¥ μ‹¤ν¨** (20% κ°€λ¥μ„±)
   - ν”„λ΅ νΈμ—”λ“μ—μ„ API ν‚¤ μ „μ†΅ μ‹¤ν¨
   - λ°±μ—”λ“ μ €μ¥ κ³Όμ • μ‹¤ν¨

3. **λ³µνΈν™” μ‹¤ν¨** (10% κ°€λ¥μ„±)
   - μ•”νΈν™” ν‚¤ λ³€κ²½
   - λ³µνΈν™” κ³Όμ • μ¤λ¥

## μ¶”κ°€ λ””λ²„κΉ… λ„κµ¬

### API ν‚¤ μ €μ¥ μ—¬λ¶€ ν™•μΈ μ—”λ“ν¬μΈνΈ

```bash
GET /auth/api-keys/status
Authorization: Bearer {ν† ν°}
```

μ‘λ‹µ:
```json
{
  "hasOpenAI": false,
  "hasGoogle": false,
  "hasAnthropic": true
}
```

μ΄ μ—”λ“ν¬μΈνΈλ¥Ό μ‚¬μ©ν•μ—¬ API ν‚¤κ°€ μ €μ¥λμ—λ”μ§€ ν™•μΈν•  μ μμµλ‹λ‹¤.

